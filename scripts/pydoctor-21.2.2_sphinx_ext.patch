From 439299fc32e7f67d338f85fc919cd42ec293e639 Mon Sep 17 00:00:00 2001
From: Fabio Zanini <fabio.zanini@fastmail.fm>
Date: Sun, 26 Dec 2021 08:40:16 +1100
Subject: [PATCH] Sphinx ext: skip temp dir renaming if absent

---
 pydoctor/sphinx_ext/build_apidocs.py | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/pydoctor/sphinx_ext/build_apidocs.py b/pydoctor/sphinx_ext/build_apidocs.py
index 06da7cef..a6204c20 100644
--- a/pydoctor/sphinx_ext/build_apidocs.py
+++ b/pydoctor/sphinx_ext/build_apidocs.py
@@ -64,7 +64,8 @@ def on_build_finished(app: Sphinx, exception: Exception) -> None:
 
         temp_path = output_path.with_suffix('.pydoctor_temp')
         shutil.rmtree(sphinx_files, ignore_errors=True)
-        output_path.rename(sphinx_files)
+        if os.path.isdir(output_path):
+            output_path.rename(sphinx_files)
         temp_path.rename(output_path)
 
 
-- 
2.34.1

